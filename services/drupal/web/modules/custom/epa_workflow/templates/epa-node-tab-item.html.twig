{% set is_button = true %}
{% set element = 'button' %}
{% set link_class = 'epa-node-tabs__button' %}

{% if url %}
  {% set is_button = false %}
  {% set element = 'a' %}
  {% set href %} href="{{ url }}"{% endset %}
  {% set link_class = 'epa-node-tabs__link' %}
{% endif %}

{% if url|render|striptags|trim is empty %}
  {% set element = 'span' %}
  {% set href = '' %}

  {% if not is_active %}
    {% set is_disabled = true %}
  {% endif %}
{% endif %}

{% set additional_attributes = {
  'class': [
    is_child ? 'epa-node-tabs__drawer-link' : link_class,
    is_active ? 'is-active',
    is_disabled ? 'is-disabled',
  ],
} %}

{% if is_active %}
  {% set additional_attributes = additional_attributes|merge({
    'aria-current': 'page',
  }) %}
{% endif %}

{% if is_button %}
  {% set additional_attributes = additional_attributes|merge({
    'id': 'epa-node-tabs-button',
    'aria-expanded': 'true',
    'aria-controls': 'epa-node-tabs-drawer',
  }) %}
{% endif %}

<{{ element}} {{ add_attributes(additional_attributes) }}{{ href }}>

  {% if icon %}
    <svg class="epa-node-tabs__icon" aria-hidden="true" role="img">
      <use href="/themes/epa_theme/images/sprite.artifact.svg#{{ icon }}"></use>
    </svg>
  {% endif %}

  {{ title }}
</{{element}}>
